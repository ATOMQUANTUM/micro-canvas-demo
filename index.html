<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Micro Canvas — Anton Kononov (Interactive)</title>
<style>
  html,body{height:100%;margin:0;background:#000;color:#fff;font-family:Inter,system-ui,Segoe UI,Roboto}
  #wrap{width:100%;height:100vh;display:flex;align-items:center;justify-content:center;overflow:hidden}
  canvas{width:100%;height:100vh;display:block}
  .ui{position:fixed;left:14px;top:14px;z-index:20;background:rgba(0,0,0,0.45);padding:8px 10px;border-radius:8px;font-size:13px}
  .cta{position:fixed;right:14px;bottom:14px;background:rgba(0,0,0,0.45);padding:10px;border-radius:8px;font-size:13px}
  a{color:#ffd65a;text-decoration:none}
</style>
</head>
<body>
<div id="wrap">
  <canvas id="gl"></canvas>
</div>
<div class="ui">Micro Canvas — drag/tilt to interact • <a id="download" href="#">Download PNG</a></div>
<div class="cta">Texture: embedded image • <a href="https://antonkononov.art" target="_blank">antonkononov.art</a></div>
<script>
const canvas = document.getElementById('gl');
const gl = canvas.getContext('webgl');
if(!gl){document.body.innerHTML='WebGL not supported';throw new Error('no webgl')}
function resize(){canvas.width=innerWidth;canvas.height=innerHeight;gl.viewport(0,0,gl.drawingBufferWidth,gl.drawingBufferHeight)}
window.addEventListener('resize',resize);resize();

const vs = `attribute vec2 position; varying vec2 vUv; void main(){vUv = position*0.5+0.5; gl_Position = vec4(position,0.0,1.0);}`;
const fs = `precision mediump float; varying vec2 vUv; uniform sampler2D u_tex; uniform vec2 u_res; uniform vec2 u_mouse; uniform float u_time;

// convert uv to -1..1
vec2 aspect(vec2 uv){uv -= 0.5; uv.x *= u_res.x/u_res.y; return uv; }

void main(){ vec2 uv = vUv; vec2 p = aspect(uv);
 // compute polar coords for subtle warping
 float r = length(p);
 float a = atan(p.y,p.x);
 // animated swirl based on time and mouse
 float t = u_time*0.6;
 float swirl = 0.25 * sin(3.0*a + t + u_mouse.x*2.0);
 float radius = r + swirl*0.05;
 // create spherical distortion
 float sphere = sqrt(max(0.0,1.0 - radius*radius));
 vec2 sph = vec2(radius*cos(a), radius*sin(a));
 // vignette
 float vig = smoothstep(0.9,0.3,r);
 // parallax offset from mouse
 vec2 m = (u_mouse - 0.5) * 0.08;
 vec2 coord = uv + m * (1.0 - pow(r,0.9));
 // sample texture with subtle displacement
 vec2 disp = 0.012 * vec2(cos(a*8.0 + t), sin(a*6.0 - t)) * (1.0 - r);
 vec4 col = texture2D(u_tex, coord + disp);
 // add highlight overlay
 float gloss = pow(max(0.0, sphere), 8.0);
 col.rgb += gloss * 0.35;
 // gold tint boost
 col.rgb = mix(col.rgb, col.rgb * vec3(1.06,0.96,0.6), 0.25);
 // apply vignette
 col.rgb *= mix(1.0, 0.55, vig);
 gl_FragColor = vec4(col.rgb, 1.0);
}`;

function compile(src,type){const s=gl.createShader(type);gl.shaderSource(s,src);gl.compileShader(s);if(!gl.getShaderParameter(s,gl.COMPILE_STATUS)){console.error(gl.getShaderInfoLog(s));}return s}
const prog = gl.createProgram(); gl.attachShader(prog,compile(vs,gl.VERTEX_SHADER)); gl.attachShader(prog,compile(fs,gl.FRAGMENT_SHADER)); gl.linkProgram(prog); gl.useProgram(prog);

// quad
const buf = gl.createBuffer(); gl.bindBuffer(gl.ARRAY_BUFFER,buf); gl.bufferData(gl.ARRAY_BUFFER, new Float32Array([-1,-1,1,-1,-1,1,1,1]), gl.STATIC_DRAW);
const pos = gl.getAttribLocation(prog,'position'); gl.enableVertexAttribArray(pos); gl.vertexAttribPointer(pos,2,gl.FLOAT,false,0,0);

const u_res = gl.getUniformLocation(prog,'u_res'); const u_mouse = gl.getUniformLocation(prog,'u_mouse'); const u_time = gl.getUniformLocation(prog,'u_time');

// load texture from inbound media
const img = new Image(); img.crossOrigin = 'anonymous'; img.onload = ()=>{ const tex = gl.createTexture(); gl.bindTexture(gl.TEXTURE_2D,tex); gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, true); gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE); gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE); gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR); gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR); gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,gl.RGBA,gl.UNSIGNED_BYTE,img); startRender(); };
// path to image file (attached) — same directory when downloaded
img.src = './0a46a4b6-82b4-4e93-b2b0-c84fec1910a5.jpg';

let mouseX=0.5, mouseY=0.5; window.addEventListener('mousemove',e=>{mouseX=e.clientX/window.innerWidth; mouseY=1.0 - e.clientY/window.innerHeight}); window.addEventListener('touchmove',e=>{e.preventDefault();mouseX=e.touches[0].clientX/window.innerWidth; mouseY=1.0 - e.touches[0].clientY/window.innerHeight},{passive:false});
let start=Date.now();
function startRender(){function frame(){gl.uniform2f(u_res, canvas.width, canvas.height); gl.uniform2f(u_mouse, mouseX, mouseY); gl.uniform1f(u_time, (Date.now()-start)/1000.0); gl.drawArrays(gl.TRIANGLE_STRIP,0,4); requestAnimationFrame(frame);} frame();}

// download png
document.getElementById('download').addEventListener('click',e=>{e.preventDefault(); const url = canvas.toDataURL('image/png'); const a=document.createElement('a'); a.href=url; a.download='micro-canvas-anton.png'; a.click();});

// initial resize
resize();
</script>
</body>
</html>